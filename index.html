
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Lokasi Fast Charging</title>

<!-- Leaflet (Wajib untuk Jawg Maps) -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
  body { margin: 0; padding: 0; font-family: Arial; }

  #mapWrapper {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(4px);
    display: none;
    z-index: 9999;
  }

  #mapBox {
    width: 100%;
    height: 75vh;
    background: #000;
    border-radius: 16px 16px 0 0;
    position: absolute;
    bottom: 0;
    left: 0;
    overflow: hidden;
  }

  #map {
    width: 100%;
    height: 100%;
  }

  .closeBtn {
    position: absolute;
    top: 10px;
    right: 14px;
    padding: 8px 16px;
    background: white;
    border-radius: 10px;
    font-weight: bold;
    z-index: 9999;
  }

  .gmapBtn {
    width: calc(100% - 40px);
    margin: 10px 20px 20px 20px;
    padding: 14px;
    background: white;
    border-radius: 12px;
    text-align: center;
    font-size: 18px;
    font-weight: bold;
  }
</style>
</head>
<body>

<!-- MAP WRAPPER -->
<div id="mapWrapper">
  <div class="closeBtn" onclick="closeMap()">Tutup</div>
  <div id="mapBox">
    <div id="map"></div>
  </div>
  <div id="gmapBtn" class="gmapBtn">Buka di Google Maps</div>
</div>

<script>
/* ============================
   TOKEN JAWG KAMU
============================ */
const JAWG_TOKEN = "l1PdBwk1arfZcY7wECff2jE2Ts7qpJyMqGGqHK8cjCxcLb6m0FPHm1sExB5NvLyA";

/* ============================
   ICON CUSTOM (Motor + Petir)
============================ */
const userIcon = L.icon({
    iconUrl: "https://cdn-icons-png.flaticon.com/512/3202/3202926.png", // ikon motor
    iconSize: [50, 50],
    iconAnchor: [25, 25]
});

const chargerIcon = L.icon({
    iconUrl: "https://cdn-icons-png.flaticon.com/512/869/869869.png", // ikon petir
    iconSize: [55, 55],
    iconAnchor: [27, 27]
});

/* ============================
   FUNGSI BUKA MAP
============================ */
let map;
let userMarker;
let fcMarker;

function openMap(fcName, lat, lng) {
    document.getElementById("mapWrapper").style.display = "block";

    if (!map) {
        map = L.map("map").setView([lat, lng], 16);

        L.tileLayer(
            `https://tile.jawg.io/jawg-streets/{z}/{x}/{y}.png?access-token=${JAWG_TOKEN}`,
            {
                maxZoom: 22,
                attribution: '<a href="https://jawg.io" target="_blank">© Jawg Maps</a>'
            }
        ).addTo(map);
    } else {
        map.setView([lat, lng], 16);
    }

    // Marker Fast Charging
    if (fcMarker) map.removeLayer(fcMarker);
    fcMarker = L.marker([lat, lng], { icon: chargerIcon }).addTo(map)
      .bindPopup(`<b>${fcName}</b>`).openPopup();

    // Lokasi User (GPS)
    navigator.geolocation.getCurrentPosition(pos => {
        let uLat = pos.coords.latitude;
        let uLng = pos.coords.longitude;

        if (userMarker) map.removeLayer(userMarker);

        userMarker = L.marker([uLat, uLng], { icon: userIcon }).addTo(map)
          .bindPopup("Lokasi Anda").openPopup();
    });

    // Tombol buka Google Maps
    document.getElementById("gmapBtn").onclick = () => {
        window.open(`https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}`, "_blank");
    };
}

/* ============================
   FUNGSI TUTUP MAP
============================ */
function closeMap() {
    document.getElementById("mapWrapper").style.display = "none";
}

/* ============================
   CONTOH PEMANGGILAN
   (nanti kamu ganti sesuai klik)
============================ */
// Contoh → buka map Bethany Motor
// openMap("Bethany Motor", -6.2222, 106.8531);

</script>

</body>
</html>
